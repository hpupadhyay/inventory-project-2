{% extends "inventory/base.html" %}

{% block content %}
<h2 class="text-3xl font-bold mb-6">Opening Stock</h2>

{% if messages %}{% for message in messages %}
<div class="p-4 mb-4 text-sm rounded-lg {% if message.tags == 'success' %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %}" role="alert">{{ message }}</div>
{% endfor %}{% endif %}

<div class="bg-white p-6 rounded-lg shadow-md mb-8">
    <h3 class="text-xl font-bold mb-4">Import Opening Stock</h3>
    <p class="text-sm text-gray-600 mb-2">Upload a CSV to set or override stock levels. The item and warehouse must already exist.</p>
    <div class="flex space-x-2">
        <form method="post" class="inline">
            {% csrf_token %}
            <button type="submit" name="download_template" class="bg-blue-500 text-white px-3 py-1.5 rounded-md text-sm hover:bg-blue-600">Download Template</button>
        </form>
        <form method="post" enctype="multipart/form-data" class="inline-flex items-center">
            {% csrf_token %}
            <input type="file" name="csv_file" accept=".csv" required class="text-sm">
            <button type="submit" name="import_csv" class="bg-green-500 text-white px-3 py-1.5 rounded-md text-sm hover:bg-green-600 ml-2">Import CSV</button>
        </form>
    </div>
</div>

<div class="bg-white p-6 rounded-lg shadow-md overflow-x-auto">
    <h3 class="text-xl font-bold mb-4">Current Stock Levels</h3>
    <table class="min-w-full bg-white">
        <thead class="bg-gray-100">
            <tr>
                <th class="py-2 px-4 border-b text-left">Item Name</th>
                <th class="py-2 px-4 border-b text-left">Warehouse</th>
                <th class="py-2 px-4 border-b text-left">Quantity</th>
            </tr>
        </thead>
        <tbody>
            {% for stock in stock_data %}
            <tr class="hover:bg-gray-50">
                <td class="py-2 px-4 border-b">{{ stock.item.name }}</td>
                <td class="py-2 px-4 border-b">{{ stock.warehouse.name }}</td>
                <td class="py-2 px-4 border-b">{{ stock.quantity }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="py-4 text-center text-gray-500">No stock data found.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}